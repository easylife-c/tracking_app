{% extends 'base.html' %}
{% block content %}
<section class="toolbar">
	<form class="filters" method="get" action="{{ url_for('index') }}">
		<input type="text" name="q" value="{{ q }}" placeholder="Search by name, class, location">
		<select name="status">
			<option value="">All statuses</option>
			{% for s in statuses %}
				<option value="{{ s }}" {% if active_status==s %}selected{% endif %}>{{ s.title() }}</option>
			{% endfor %}
		</select>
		<button class="btn" type="submit">Filter</button>
	</form>
</section>

<section class="cards">
	{% if items %}
		<ul class="card-list">
			{% for item in items %}
				<li class="card">
					<div class="thumb">
						{% if item.image_filename %}
							<img src="{{ url_for('static', filename='uploads/' ~ item.image_filename) }}" alt="item image">
						{% else %}
							<div class="placeholder">No image</div>
						{% endif %}
					</div>
					<div class="info">
						<h3>{{ item.person_name }}</h3>
						<p><strong>Class:</strong> {{ item.class_name }}</p>
						<p><strong>Return to:</strong> {{ item.return_location }}</p>
						<p class="status {{ item.status|lower }}">Status: {{ item.status.title() }}</p>
						<form class="inline" method="post" action="{{ url_for('update_status', item_id=item.id) }}">
							<select name="status">
								{% for s in statuses %}
									<option value="{{ s }}" {% if item.status==s %}selected{% endif %}>{{ s.title() }}</option>
								{% endfor %}
							</select>
							<button class="btn small" type="submit">Update</button>
						</form>
					</div>
				</li>
			{% endfor %}
		</ul>
	{% else %}
		<p>No reports yet. <a href="{{ url_for('create') }}">Create one</a>.</p>
	{% endif %}
</section>
{% endblock %}